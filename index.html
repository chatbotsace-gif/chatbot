<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assistente Virtual Profissional</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',Tahoma,sans-serif;background:linear-gradient(135deg,#0f172a,#1e293b);color:#e2e8f0;display:flex;flex-direction:column;height:100vh;overflow:hidden;}
.header{padding:16px 20px;background:linear-gradient(135deg,#1e40af,#3b82f6);display:flex;align-items:center;gap:12px;box-shadow:0 2px 8px rgba(0,0,0,0.3);}
.logo{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#60a5fa,#3b82f6);}
.header-title{flex:1;}
.header-title h1{font-size:18px;font-weight:600;}
.header-title p{font-size:12px;opacity:0.8;}
.status{font-size:12px;padding:4px 10px;border-radius:20px;background:rgba(16,185,129,0.2);border:1px solid rgba(16,185,129,0.3);}
.status-dot{width:8px;height:8px;background:#10b981;border-radius:50%;display:inline-block;margin-right:4px;animation:pulse 2s infinite;}
@keyframes pulse{0%,100%{opacity:1;}50%{opacity:0.5;}}
.quickActions{display:flex;gap:8px;overflow-x:auto;padding:8px 12px;background:rgba(15,23,42,0.9);}
.quickActions button{padding:8px 14px;border:none;border-radius:20px;background:rgba(37,99,235,0.2);color:#93c5fd;font-size:13px;white-space:nowrap;cursor:pointer;}
.quickActions button:hover{background:rgba(59,130,246,0.3);}
.messages{flex:1;overflow-y:auto;padding:14px;display:flex;flex-direction:column;gap:14px;scroll-behavior:smooth;}
.msg-wrapper{display:flex;gap:10px;}
.msg-wrapper.me{flex-direction:row-reverse;}
.avatar{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;}
.avatar.user{background:linear-gradient(135deg,#8b5cf6,#6366f1);}
.avatar.bot{background:linear-gradient(135deg,#06b6d4,#0891b2);}
.msg{padding:10px 14px;border-radius:16px;max-width:75%;font-size:14px;line-height:1.4;}
.msg-wrapper.me .msg{background:linear-gradient(135deg,#8b5cf6,#6366f1);color:#fff;}
.msg-wrapper.bot .msg{background:rgba(30,41,59,0.8);border:1px solid rgba(59,130,246,0.2);}
.inputArea{display:flex;padding:10px;gap:8px;background:rgba(15,23,42,0.95);border-top:1px solid rgba(59,130,246,0.2);position:fixed;bottom:0;left:0;width:100%;z-index:10;}
.inputArea input{flex:1;padding:12px 16px;border-radius:24px;border:2px solid rgba(59,130,246,0.3);background:rgba(30,41,59,0.6);color:#e2e8f0;font-size:14px;outline:none;}
.inputArea button{padding:12px 18px;border:none;border-radius:24px;background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;font-weight:600;font-size:14px;cursor:pointer;}
#micBtn{background:linear-gradient(135deg,#10b981,#059669);}
</style>
</head>
<body>

<div class="header">
  <div class="logo">🤖</div>
  <div class="header-title">
    <h1>Assistente Virtual</h1>
    <p>Fala, ouve e resolve cálculos!</p>
  </div>
  <div class="status"><span class="status-dot"></span>Online</div>
</div>

<div class="quickActions">
  <button onclick="sendQuick('Oi')">👋 Oi</button>
  <button onclick="sendQuick('Que horas são?')">⏰ Hora</button>
  <button onclick="sendQuick('Qual a data de hoje?')">📅 Data</button>
  <button onclick="sendQuick('Me conte uma piada')">😄 Piada</button>
  <button onclick="sendQuick('10 + 25 * 2')">🧮 Cálculo</button>
</div>

<div id="messages" class="messages"></div>

<div class="inputArea">
  <input id="inputMsg" placeholder="Digite aqui..." autocomplete="off">
  <button id="micBtn">🎤</button>
  <button id="sendBtn">Enviar</button>
</div>

<script>
const messagesEl = document.getElementById('messages');
const input = document.getElementById('inputMsg');
const sendBtn = document.getElementById('sendBtn');
const micBtn = document.getElementById('micBtn');
let userName = null;

// Função para mensagens
function addMessage(text, who='bot'){
  const wrap = document.createElement('div');
  wrap.className = 'msg-wrapper '+who;
  const avatar = document.createElement('div');
  avatar.className = 'avatar '+(who==='me'?'user':'bot');
  avatar.textContent = who==='me'?'👤':'🤖';
  const msg = document.createElement('div');
  msg.className = 'msg';
  msg.textContent = text;
  wrap.appendChild(avatar);
  wrap.appendChild(msg);
  messagesEl.appendChild(wrap);
  messagesEl.scrollTop = messagesEl.scrollHeight;
  speak(text, who);
}

// Botões rápidos
function sendQuick(text){
  addMessage(text,'me');
  setTimeout(()=>botRespond(text),'300');
}

// Fala do bot
function speak(text, who){
  if(who!=='bot') return;
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = 'pt-BR'; utter.rate=1; utter.pitch=1;
  speechSynthesis.speak(utter);
}

// Reconhecimento de voz
micBtn.addEventListener('click', ()=>{
  if(!('webkitSpeechRecognition' in window)){alert("⚠️ Navegador não suporta reconhecimento de voz."); return;}
  const rec = new webkitSpeechRecognition();
  rec.lang = 'pt-BR';
  rec.onresult = e=>{
    input.value = e.results[0][0].transcript;
    handleSend();
  };
  rec.start();
});

// Função de cálculo avançado
function calcExpr(expr){
  try{
    expr = expr.replace(/\s+/g,''); // remove espaços
    expr = expr.replace(/√/g,'Math.sqrt');
    expr = expr.replace(/\^/g,'**');
    expr = expr.replace(/(\d+)!/g, (_,n)=>{let f=1;for(let i=1;i<=+n;i++)f*=i;return f;});
    expr = expr.replace(/log\(([^)]+)\)/g,'Math.log10($1)');
    expr = expr.replace(/ln\(([^)]+)\)/g,'Math.log($1)');
    if(!/^[0-9+\-*/().Mathsqrt**logln]+$/.test(expr)) return "⚠️ Cálculo inválido.";
    return `🧮 ${expr} = ${eval(expr)}`;
  }catch{return "❌ Erro ao calcular.";}
}

// Resposta do bot
async function botRespond(msg){
  addMessage("💬 Processando...", 'bot');
  let response = '';
  msg = msg.toLowerCase().trim();
  if(!userName){
    userName = msg.replace(/[^a-zA-ZÀ-ÿ\s]/g,'').trim();
    response = userName?`Prazer, ${userName}! 😊 Como posso te ajudar hoje?`:"Olá! Qual é o seu nome? 😄";
  }
  else if(/^[0-9+\-*/().√^!logln\s]+$/.test(msg)) response = calcExpr(msg);
  else if(msg.includes('oi')||msg.includes('olá')) response = `Oi, ${userName}! 👋 Tudo bem?`;
  else if(msg.includes('hora')) response = `Agora são ${new Date().toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'})}.`;
  else if(msg.includes('data')) response = `Hoje é ${new Date().toLocaleDateString('pt-BR',{weekday:'long',day:'numeric',month:'long',year:'numeric'})}.`;
  else if(msg.includes('piada')) response = "😂 Por que o livro de matemática ficou triste? Porque ele tinha muitos problemas!";
  else response = "🤖 Ainda não entendo completamente, mas posso aprender!";

  const last = messagesEl.querySelector('.msg-wrapper.bot:last-child .msg');
  if(last) last.textContent = response;
  speak(response, 'bot');
}

// Envio
function handleSend(){
  const text = input.value.trim();
  if(!text) return;
  addMessage(text,'me');
  input.value = '';
  botRespond(text);
}

sendBtn.addEventListener('click', handleSend);
input.addEventListener('keypress', e=>{if(e.key==='Enter') handleSend();});
window.addEventListener('resize', ()=>{document.body.style.height=window.innerHeight+'px'; messagesEl.scrollTop = messagesEl.scrollHeight;});

// Mensagem inicial
setTimeout(()=>addMessage('Olá! 👋 Seja bem-vindo(a)! Qual é o seu nome? 😊'), 500);
</script>

</body>
</html>
