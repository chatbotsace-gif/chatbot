<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assistente Virtual</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#0f172a,#1e293b);color:#e2e8f0;display:flex;flex-direction:column;height:100vh;}
.header{padding:16px;background:linear-gradient(135deg,#1e40af,#3b82f6);display:flex;align-items:center;gap:12px;}
.logo{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#60a5fa,#3b82f6);display:flex;justify-content:center;align-items:center;font-size:20px;}
.header h1{font-size:20px;}
.messages{flex:1;padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:14px;}
.msg-wrapper{display:flex;gap:12px;}
.msg-wrapper.me{flex-direction:row-reverse;}
.msg{padding:12px 16px;border-radius:16px;max-width:70%;line-height:1.5;}
.msg-wrapper.me .msg{background:linear-gradient(135deg,#8b5cf6,#6366f1);color:#fff;}
.msg-wrapper.bot .msg{background:rgba(30,41,59,0.8);border:1px solid rgba(59,130,246,0.3);}
.inputArea{display:flex;padding:16px;gap:12px;background:rgba(15,23,42,0.95);}
.inputArea input{flex:1;padding:14px 18px;border-radius:24px;border:2px solid rgba(59,130,246,0.3);background:rgba(30,41,59,0.6);color:#e2e8f0;}
.inputArea button{padding:14px 24px;border:none;border-radius:24px;background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;cursor:pointer;}
</style>
</head>
<body>

<div class="header">
  <div class="logo">🤖</div>
  <h1>Assistente Virtual</h1>
</div>

<div id="messages" class="messages"></div>

<div class="inputArea">
  <input id="inputMsg" placeholder="Digite sua mensagem..." autocomplete="off">
  <button id="sendBtn">Enviar</button>
</div>

<script>
const messagesEl=document.getElementById('messages');
const input=document.getElementById('inputMsg');
const sendBtn=document.getElementById('sendBtn');

let nomeUsuario=null;
let aguardandoConfirmacao=false;
let aguardandoNome=true;

// Função de adicionar mensagens
function addMessage(text,who='bot'){
  const wrapper=document.createElement('div');
  wrapper.className='msg-wrapper '+who;
  const msg=document.createElement('div');
  msg.className='msg';
  msg.textContent=text;
  wrapper.appendChild(msg);
  messagesEl.appendChild(wrapper);
  messagesEl.scrollTop=messagesEl.scrollHeight;
}

// Função para cálculos matemáticos
function calcular(expr){
  if(!/^[0-9+\-*/().\s]+$/.test(expr)) return "❌ Expressão inválida!";
  try{
    const resultado=Function('"use strict";return ('+expr+')')();
    return `🧮 Resultado: ${resultado}`;
  }catch{
    return "❌ Não consegui calcular isso.";
  }
}

// Função principal do bot
function botResponder(texto){
  const t=texto.trim().toLowerCase();

  // Se estiver aguardando o nome
  if(aguardandoNome){
    if(!/^[a-zA-ZÀ-ÿ\s]+$/.test(texto)){
      return "Digite apenas letras, por favor. 😊 Qual é o seu nome?";
    } else {
      nomeUsuario = texto.charAt(0).toUpperCase() + texto.slice(1);
      aguardandoNome=false;
      aguardandoConfirmacao=true;
      return `Seu nome é ${nomeUsuario}? (responda com "sim" ou "não")`;
    }
  }

  // Se estiver aguardando confirmação do nome
  if(aguardandoConfirmacao){
    if(t.includes('sim')){
      aguardandoConfirmacao=false;
      return `Perfeito, ${nomeUsuario}! 😄 Agora posso te ajudar com cálculos matemáticos.`;
    } else if(t.includes('não')){
      aguardandoNome=true;
      return "Ah, entendi 😅. Então, por favor, digite seu nome novamente (apenas letras).";
    } else {
      return "Responda apenas com 'sim' ou 'não'.";
    }
  }

  // Se for uma expressão matemática
  if(/[0-9+\-*/().]+/.test(texto)) return calcular(texto);

  // Outros tipos de mensagem
  if(t.includes('oi')||t.includes('olá')) return `Olá, ${nomeUsuario}! 😄`;
  if(t.includes('tchau')||t.includes('até')) return `Até logo, ${nomeUsuario}! 👋`;
  if(t.includes('hora')) return `🕒 Agora são ${new Date().toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'})}, ${nomeUsuario}.`;
  if(t.includes('data')) return `📅 Hoje é ${new Date().toLocaleDateString('pt-BR',{weekday:'long',year:'numeric',month:'long',day:'numeric'})}.`;

  return `Desculpe, ${nomeUsuario}, eu só sei resolver cálculos no momento. 😅`;
}

// Função de envio
function enviarMensagem(){
  const texto=input.value.trim();
  if(!texto) return;
  addMessage(texto,'me');
  input.value='';
  setTimeout(()=>{
    const resposta=botResponder(texto);
    addMessage(resposta,'bot');
  },500);
}

sendBtn.addEventListener('click',enviarMensagem);
input.addEventListener('keypress',e=>{if(e.key==='Enter') enviarMensagem();});

// Mensagem inicial
setTimeout(()=>{
  addMessage("Olá! 👋 Eu sou seu assistente virtual de matemática.");
  setTimeout(()=>addMessage("Qual é o seu nome? (apenas letras, por favor)"),700);
},500);
</script>

</body>
</html>
