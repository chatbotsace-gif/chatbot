<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assistente Virtual  </title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',Tahoma,sans-serif;background:linear-gradient(135deg,#0f172a,#1e293b);color:#e2e8f0;display:flex;flex-direction:column;height:100vh;overflow:hidden;}
.header{padding:16px 20px;background:linear-gradient(135deg,#1e40af,#3b82f6);display:flex;align-items:center;gap:12px;box-shadow:0 2px 8px rgba(0,0,0,0.3);}
.logo{width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#60a5fa,#3b82f6);font-size:28px;}
.header-title{flex:1;}
.header-title h1{font-size:20px;font-weight:700;}
.header-title p{font-size:13px;opacity:0.85;}
.status{font-size:12px;padding:5px 12px;border-radius:20px;background:rgba(16,185,129,0.2);border:1px solid rgba(16,185,129,0.3);}
.status-dot{width:8px;height:8px;background:#10b981;border-radius:50%;display:inline-block;margin-right:5px;animation:pulse 2s infinite;}
@keyframes pulse{0%,100%{opacity:1;}50%{opacity:0.5;}}
.quickActions{display:flex;gap:8px;overflow-x:auto;padding:10px;background:rgba(15,23,42,0.9);}
.quickActions button{padding:10px 16px;border:none;border-radius:24px;background:rgba(37,99,235,0.2);color:#93c5fd;font-size:14px;white-space:nowrap;cursor:pointer;transition:0.2s;}
.quickActions button:hover{background:rgba(59,130,246,0.3);}
.messages{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:16px;scroll-behavior:smooth;}
.msg-wrapper{display:flex;gap:12px;}
.msg-wrapper.me{flex-direction:row-reverse;}
.avatar{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;}
.avatar.user{background:linear-gradient(135deg,#8b5cf6,#6366f1);}
.avatar.bot{background:linear-gradient(135deg,#06b6d4,#0891b2);}
.msg{padding:12px 18px;border-radius:20px;max-width:75%;font-size:15px;line-height:1.5;word-break:break-word;}
.msg-wrapper.me .msg{background:linear-gradient(135deg,#8b5cf6,#6366f1);color:#fff;}
.msg-wrapper.bot .msg{background:rgba(30,41,59,0.9);border:1px solid rgba(59,130,246,0.3);}
.inputArea{display:flex;padding:12px;gap:8px;background:rgba(15,23,42,0.95);border-top:1px solid rgba(59,130,246,0.2);position:fixed;bottom:0;left:0;width:100%;z-index:10;}
.inputArea input{flex:1;padding:14px 18px;border-radius:28px;border:2px solid rgba(59,130,246,0.3);background:rgba(30,41,59,0.7);color:#e2e8f0;font-size:15px;outline:none;}
.inputArea button{padding:14px 20px;border:none;border-radius:28px;background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;font-weight:600;font-size:15px;cursor:pointer;transition:0.2s;}
.inputArea button:hover{opacity:0.9;}
#micBtn{background:linear-gradient(135deg,#10b981,#059669);}
</style>
</head>
<body>

<div class="header">
  <div class="logo">🤖</div>
  <div class="header-title">
    <h1>Assistente Virtual</h1>
    <p>Fala, ouve e resolve cálculos avançados!</p>
  </div>
  <div class="status"><span class="status-dot"></span>Online</div>
</div>

<div class="quickActions">
  <button onclick="sendQuick('Oi')">👋 Oi</button>
  <button onclick="sendQuick('Que horas são?')">⏰ Hora</button>
  <button onclick="sendQuick('Qual a data de hoje?')">📅 Data</button>
  <button onclick="sendQuick('Me conte uma piada')">😄 Piada</button>
  <button onclick="sendQuick('√64')">🧮 Raiz Quadrada</button>
  <button onclick="sendQuick('2^8')">🧮 Potência</button>
  <button onclick="sendQuick('10!')">🧮 Fatorial</button>
  <button onclick="sendQuick('log10(1000)')">🧮 Logaritmo</button>
</div>

<div id="messages" class="messages"></div>

<div class="inputArea">
  <input id="inputMsg" placeholder="Digite aqui..." autocomplete="off">
  <button id="micBtn">🎤</button>
  <button id="sendBtn">Enviar</button>
</div>

<script>
const messagesEl=document.getElementById('messages');
const input=document.getElementById('inputMsg');
const sendBtn=document.getElementById('sendBtn');
const micBtn=document.getElementById('micBtn');
let userName=null;

function addMessage(text,who='bot'){
  const wrap=document.createElement('div');
  wrap.className='msg-wrapper '+who;
  const avatar=document.createElement('div');
  avatar.className='avatar '+(who==='me'?'user':'bot');
  avatar.textContent=who==='me'?'👤':'🤖';
  const msg=document.createElement('div');
  msg.className='msg';
  msg.textContent=text;
  wrap.appendChild(avatar);
  wrap.appendChild(msg);
  messagesEl.appendChild(wrap);
  messagesEl.scrollTop=messagesEl.scrollHeight;
  speak(text,who);
}

function sendQuick(text){
  addMessage(text,'me');
  setTimeout(()=>addMessage(botRespond(text),'bot'),400);
}

// Função de cálculo avançado
function calcExpr(expr){
  expr=expr.replace(/[^0-9+\-*/().√^!log\s]/g,'');
  try{
    // Raiz quadrada
    expr=expr.replace(/√(\d+(\.\d+)?)/g,'Math.sqrt($1)');
    // Potência
    expr=expr.replace(/(\d+(\.\d+)?)\^(\d+(\.\d+)?)/g,'Math.pow($1,$3)');
    // Fatorial
    expr=expr.replace(/(\d+)!/g,(match,p1)=>{
      let n=parseInt(p1),f=1;
      for(let i=2;i<=n;i++) f*=i;
      return f;
    });
    // Logaritmo base 10
    expr=expr.replace(/log(\d+(\.\d+)?)/g,'Math.log10($1)');
    return `🧮 ${expr} = ${eval(expr)}`;
  }catch{
    return "❌ Erro ao calcular.";
  }
}

function botRespond(msg){
  msg=msg.toLowerCase().trim();
  if(!userName){
    userName=msg.replace(/[^a-zA-ZÀ-ÿ\s]/g,'').trim();
    if(userName) return `Prazer, ${userName}! 😊 Como posso te ajudar hoje?`;
    else return "Olá! Qual é o seu nome? 😄";
  }
  if(msg.includes('oi')||msg.includes('olá')) return `Oi, ${userName}! 👋 Tudo bem?`;
  if(msg.includes('hora')) return `Agora são ${new Date().toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'})}.`;
  if(msg.includes('data')) return `Hoje é ${new Date().toLocaleDateString('pt-BR',{weekday:'long',day:'numeric',month:'long',year:'numeric'})}.`;
  if(msg.includes('piada')) return "😂 Por que o livro de matemática ficou triste? Porque ele tinha muitos problemas!";
  if(/[0-9+\-*/().√^!log]/.test(msg)) return calcExpr(msg);
  return `Desculpe, ${userName}, ainda não entendo essa pergunta. 🤖`;
}

function handleSend(){
  const text=input.value.trim();
  if(!text)return;
  addMessage(text,'me');
  input.value='';
  setTimeout(()=>addMessage(botRespond(text),'bot'),400);
}

sendBtn.addEventListener('click',handleSend);
input.addEventListener('keypress',e=>{if(e.key==='Enter')handleSend();});

// Ajusta layout mobile
window.addEventListener('resize',()=>{
  document.body.style.height=window.innerHeight+'px';
  messagesEl.scrollTop=messagesEl.scrollHeight;
});

// Voz
function speak(text,who){
  if(who!=='bot')return;
  const utter=new SpeechSynthesisUtterance(text);
  utter.lang='pt-BR';
  utter.rate=1;
  utter.pitch=1;
  speechSynthesis.speak(utter);
}

// Microfone
micBtn.addEventListener('click',()=>{
  if(!('webkitSpeechRecognition' in window)){
    alert("⚠️ Seu navegador não suporta reconhecimento de voz.");
    return;
  }
  const rec=new webkitSpeechRecognition();
  rec.lang='pt-BR';
  rec.onresult=function(e){
    const result=e.results[0][0].transcript;
    input.value=result;
    handleSend();
  };
  rec.start();
});

setTimeout(()=>addMessage('Olá! 👋 Seja bem-vindo(a)! Qual é o seu nome? 😊'),'500');
</script>

</body>
</html>
